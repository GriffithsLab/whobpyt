
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>whobpyt.optimization.cost_PSD &#8212; WhoBPyT 0.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/theme_override.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=3e6ca1ad"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=a56c686a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/whobpyt/optimization/cost_PSD';</script>
    <script src="../../../_static/debug.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.0.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">WhoBPyT 0.0.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about_whobpyt/overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about_whobpyt/architecture.html">
    Code Architecture
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about_whobpyt/background.html">
    Background Information
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting_started/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting_started/running_in_colab.html">
    Running whobpyt in google colab
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../getting_started/running_in_codespaces.html">
    Running whobpyt in GitHub Codespaces
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../API/models.html">
    Models
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../API/optimization.html">
    Optimization
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../API/run.html">
    Run
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../API/visualization.html">
    Visualization
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../API/datatypes.html">
    Data Types
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../../auto_examples/eg__tmseeg.html">
    Modelling TMS-EEG evoked responses
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about_whobpyt/overview.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about_whobpyt/architecture.html">
    Code Architecture
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about_whobpyt/background.html">
    Background Information
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting_started/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting_started/running_in_colab.html">
    Running whobpyt in google colab
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../getting_started/running_in_codespaces.html">
    Running whobpyt in GitHub Codespaces
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/models.html">
    Models
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/optimization.html">
    Optimization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/run.html">
    Run
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/visualization.html">
    Visualization
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../API/datatypes.html">
    Data Types
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../auto_examples/eg__tmseeg.html">
    Modelling TMS-EEG evoked responses
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">whobpyt.optimization.cost_PSD</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for whobpyt.optimization.cost_PSD</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">warnings</span><span class="w"> </span><span class="kn">import</span> <span class="n">warn</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">..datatypes</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbstractLoss</span>

<div class="viewcode-block" id="CostsPSD">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsPSD">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CostsPSD</span><span class="p">(</span><span class="n">AbstractLoss</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    WARNING: This function is no longer supported.</span>
<span class="sd">    TODO: Needs to be updated. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># TODO: Deal with num_region vs. num_channels vs. num_parcels conflict with variable naming</span>
<div class="viewcode-block" id="CostsPSD.__init__">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsPSD.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_regions</span><span class="p">,</span> <span class="n">simKey</span><span class="p">,</span> <span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">targetValue</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">empiricalData</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CostsPSD</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">simKey</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_regions</span> <span class="o">=</span> <span class="n">num_regions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simKey</span> <span class="o">=</span> <span class="n">simKey</span>  <span class="c1"># This is the index in the data simulation to extract variable time series from</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sampleFreqHz</span> <span class="o">=</span> <span class="n">sampleFreqHz</span>
        
        <span class="k">if</span> <span class="n">targetValue</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">targetValue</span> <span class="o">=</span> <span class="n">targetValue</span>
        
        <span class="k">if</span> <span class="n">empiricalData</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># In the future, if given empiricalData then will calculate the target value in this initialization function. </span>
            <span class="c1"># That will possibly involve a time series of targets, for which then the loss would need a parameter to identify</span>
            <span class="c1"># which one to fit to.</span>
            <span class="k">pass</span>
        <span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> will be deprecated.&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>



<div class="viewcode-block" id="CostsPSD.calcPSD">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsPSD.calcPSD">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calcPSD</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">minFreq</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxFreq</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axMethod</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="c1"># signal assumed to be in the form of [time_steps, regions or channels]</span>
        <span class="c1"># Returns the Power Spectrial Density with associated Hz values</span>
    
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
        
        <span class="c1"># These defines the range of the PSD to return</span>
        <span class="k">if</span> <span class="n">minFreq</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minFreq</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">maxFreq</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">maxFreq</span> <span class="o">=</span> <span class="n">sampleFreqHz</span><span class="o">//</span><span class="mi">2</span>
        
        <span class="c1"># Not sure which axis method is correct</span>
        <span class="k">if</span> <span class="n">axMethod</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fftAxis</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axMethod</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">fftAxis</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">sampleFreqHz</span><span class="o">/</span><span class="n">N</span>
        
        <span class="c1"># Take the FFT of the Signal</span>
        <span class="n">signalFFT</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># Take the square value (it is complex) so following is equivalent:</span>
        <span class="c1"># Square of absolute, or</span>
        <span class="c1"># Sum of real squared and imag squared</span>
        <span class="n">spectralDensity</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signalFFT</span><span class="p">[:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
        
        <span class="c1">#Filter to the desired range</span>
        <span class="n">minPoint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">minFreq</span><span class="o">/</span><span class="p">(</span><span class="n">sampleFreqHz</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">spectralDensity</span><span class="p">))</span>
        <span class="n">maxPoint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">maxFreq</span><span class="o">/</span><span class="p">(</span><span class="n">sampleFreqHz</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">spectralDensity</span><span class="p">))</span>
        <span class="n">sdAxis</span> <span class="o">=</span> <span class="n">fftAxis</span><span class="p">[</span><span class="n">minPoint</span><span class="p">:</span><span class="n">maxPoint</span><span class="p">]</span>
        <span class="n">sdValues</span> <span class="o">=</span> <span class="n">spectralDensity</span><span class="p">[</span><span class="n">minPoint</span><span class="p">:</span><span class="n">maxPoint</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span></div>

    
<div class="viewcode-block" id="CostsPSD.downSmoothPSD">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsPSD.downSmoothPSD">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">downSmoothPSD</span><span class="p">(</span><span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span><span class="p">,</span> <span class="n">numPoints</span> <span class="o">=</span> <span class="mi">512</span><span class="p">):</span>
        <span class="c1">#WARNING: This function will not necessarily achieve exactly numPoints number of points</span>
        
        <span class="n">kernel_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sdValues</span><span class="p">)</span><span class="o">//</span><span class="p">(</span><span class="n">numPoints</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">stride</span> <span class="o">=</span> <span class="n">kernel_size</span><span class="o">//</span><span class="mi">2</span>
        
        <span class="n">sdAxis_dS</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">avg_pool1d</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">sdAxis</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">kernel_size</span><span class="p">,</span><span class="n">stride</span><span class="p">,</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sdValues_dS</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">avg_pool1d</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">sdValues</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span> <span class="n">kernel_size</span><span class="p">,</span><span class="n">stride</span><span class="p">,</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS</span></div>

    
<div class="viewcode-block" id="CostsPSD.scalePSD">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsPSD.scalePSD">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">scalePSD</span><span class="p">(</span><span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS</span><span class="p">):</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">trapezoid</span><span class="p">(</span><span class="n">sdValues_dS</span><span class="p">,</span> <span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Alternative Method: </span>
        <span class="c1"># spacing = (sdAxis_dS[-1] - sdAxis_dS[0])/len(sdAxis_dS)</span>
        <span class="c1"># scale = torch.trapezoid(sdValues_dS, dx = spacing, dim = 0)</span>
        
        <span class="n">sdValues_dS_scaled</span> <span class="o">=</span> <span class="n">sdValues_dS</span> <span class="o">/</span> <span class="n">scale</span>
        
        <span class="k">return</span> <span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS_scaled</span></div>


    
<div class="viewcode-block" id="CostsPSD.loss">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsPSD.loss">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simData</span><span class="p">,</span> <span class="n">empData</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># simData assumed to be dict with values in the form [time_steps, regions or channels, one or more variables]</span>
        <span class="c1"># Returns the MSE of the difference between the simulated and target power spectrum</span>
        <span class="n">sim</span> <span class="o">=</span> <span class="n">simData</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simKey</span><span class="p">]</span>
        
        <span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span> <span class="o">=</span> <span class="n">powerSpectrumLoss</span><span class="o">.</span><span class="n">calcPSD</span><span class="p">(</span><span class="n">sim</span><span class="p">[:,</span> <span class="p">:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">simKey</span><span class="p">],</span> <span class="n">sampleFreqHz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">minFreq</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">maxFreq</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
        <span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS</span> <span class="o">=</span> <span class="n">powerSpectrumLoss</span><span class="o">.</span><span class="n">downSmoothPSD</span><span class="p">(</span><span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span><span class="p">,</span> <span class="n">numPoints</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS_scaled</span> <span class="o">=</span> <span class="n">powerSpectrumLoss</span><span class="o">.</span><span class="n">scalePSD</span><span class="p">(</span><span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">sdValues_dS_scaled</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetValue</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CostsFixedPSD">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsFixedPSD">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CostsFixedPSD</span><span class="p">(</span><span class="n">AbstractLoss</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updated Code that fits to a fixed PSD</span>
<span class="sd">    </span>
<span class="sd">    The simulated PSD is generated as the square of the Fast Fourier Transform (FFT). A particular range to fit on is selected. The mean is not removed, so it is recommended to set the range such as to disclude the first point of the PSD. Removing an initial transient period before calculating the PSD is also recommended. </span>
<span class="sd">    </span>
<span class="sd">    Designed for Fitting_Batch, where the model output has an extra dimension for batch. TODO: Generalize further to work in case without this dimension as well. </span>
<span class="sd">     </span>
<span class="sd">    NOTE: If using batching, the batches will be averaged before calculating the error (as opposed to having an error for each time series in the batch). </span>
<span class="sd">    </span>
<span class="sd">    Has GPU support.</span>
<span class="sd">    </span>
<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    simKey: String</span>
<span class="sd">        Name of the state variable or modality to be used as input to the cost function. </span>
<span class="sd">    num_regions: Int</span>
<span class="sd">        The number of nodes in the model. </span>
<span class="sd">    batch_size: Int</span>
<span class="sd">        The number of elements in the batch. </span>
<span class="sd">    rmTransient: Int</span>
<span class="sd">        The number of initial time steps of simulation to remove as the transient. Default: 0</span>
<span class="sd">    device: torch.device</span>
<span class="sd">        Whether to run the objective function on CPU or GPU.</span>
<span class="sd">    sampleFreqHz: Int</span>
<span class="sd">        The sampling frequency of the data.        </span>
<span class="sd">    targetValue: torch.tensor</span>
<span class="sd">        The target PSD. This is assumed to be created with the same frequency range and density as that of the PSD generated from the simulated data. </span>
<span class="sd">    empiricalData: torch.tensor</span>
<span class="sd">        NOT IMPLEMENTED: This is a placeholder for the case of getting an empirical timeseries as input, which would be applicable if doing a windowed fitting paradigm</span>
<span class="sd">       </span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="CostsFixedPSD.__init__">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsFixedPSD.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_regions</span><span class="p">,</span> <span class="n">simKey</span><span class="p">,</span> <span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">minFreq</span><span class="p">,</span> <span class="n">maxFreq</span><span class="p">,</span> <span class="n">targetValue</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">empiricalData</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rmTransient</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num_regions; Int</span>
<span class="sd">            The number of nodes in the model.             </span>
<span class="sd">        simKey: String</span>
<span class="sd">            Name of the state variable or modality to be used as input to the cost function.         </span>
<span class="sd">        sampleFreqHz: Int</span>
<span class="sd">            The sampling frequency of the data.</span>
<span class="sd">        minFreq: Int</span>
<span class="sd">            The minimum frequnecy of the PSD to return.</span>
<span class="sd">        maxFreq: Int</span>
<span class="sd">            The maximum frequency of the PSD to return.            </span>
<span class="sd">        targetValue: torch.tensor</span>
<span class="sd">            The sampling frequency of the data.</span>
<span class="sd">        empiricalData: torch.tensor</span>
<span class="sd">            NOT IMPLEMENTED: This is a placeholder for the case of getting an empirical timeseries as input, which would be applicable if doing a windowed fitting paradigm            </span>
<span class="sd">        batch_size: Int</span>
<span class="sd">            The number of elements in the batch. </span>
<span class="sd">        rmTransient: Int</span>
<span class="sd">            The number of initial time steps of simulation to remove as the transient. Default: 0        </span>
<span class="sd">        device: torch.device</span>
<span class="sd">            Whether to run the objective function on CPU or GPU.        </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">CostsFixedPSD</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">simKey</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">num_regions</span> <span class="o">=</span> <span class="n">num_regions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">simKey</span> <span class="o">=</span> <span class="n">simKey</span>  <span class="c1"># This is the index in the data simulation to extract variable time series from</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rmTransient</span> <span class="o">=</span> <span class="n">rmTransient</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sampleFreqHz</span> <span class="o">=</span> <span class="n">sampleFreqHz</span> <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minFreq</span> <span class="o">=</span> <span class="n">minFreq</span> <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxFreq</span> <span class="o">=</span> <span class="n">maxFreq</span> <span class="c1">#</span>
        
        <span class="k">if</span> <span class="n">targetValue</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">targetValue</span> <span class="o">=</span> <span class="n">targetValue</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">num_regions</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">targetValue</span> <span class="o">=</span> <span class="n">targetValue</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">num_regions</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span> <span class="c1">#TODO: Currently taking mean before MSE from all batches, need to document this</span>
        
        <span class="k">if</span> <span class="n">empiricalData</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># In the future, if given empiricalData then will calculate the target value in this initialization function. </span>
            <span class="c1"># That will possibly involve a time series of targets, for which then the loss would need a parameter to identify</span>
            <span class="c1"># which one to fit to.</span>
            <span class="k">pass</span></div>

    
<div class="viewcode-block" id="CostsFixedPSD.calcPSD">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsFixedPSD.calcPSD">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calcPSD</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">minFreq</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">maxFreq</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axMethod</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method calculates the Power Spectral Density (PSD) as the square of the Fast Fourier Transform (FFT). </span>
<span class="sd">        </span>
<span class="sd">        Tested when working with the default simulation frequency of 10,000Hz. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        signal: dict of torch.tensor</span>
<span class="sd">            The timeseries outputted by a model. Dimensions: [nodes, time, batch]</span>
<span class="sd">        sampleFreqHz: Int</span>
<span class="sd">            The sampling frequency of the data.</span>
<span class="sd">        minFreq: Int</span>
<span class="sd">            The minimum frequnecy of the PSD to return.</span>
<span class="sd">        maxFreq: Int</span>
<span class="sd">            The maximum frequency of the PSD to return.</span>
<span class="sd">        axMethod: Int</span>
<span class="sd">            Either 1 or 2 depending on the approach to calculate the PSD axis.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        sdAxis: torch.tensor</span>
<span class="sd">            The axis values of the PSD</span>
<span class="sd">        sdValues: torch.tensor</span>
<span class="sd">            The PSD values [____, ____]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        
        <span class="c1"># signal assumed to be in the form of [time_steps, regions or channels] &lt;- This is being changed</span>
        <span class="c1"># Returns the Power Spectrial Density with associated Hz values</span>
    
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rmTransient</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">rmTransient</span><span class="p">:,:]</span>
    
        <span class="n">N</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="c1"># These defines the range of the PSD to return</span>
        <span class="k">if</span> <span class="n">minFreq</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">minFreq</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">maxFreq</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">maxFreq</span> <span class="o">=</span> <span class="n">sampleFreqHz</span><span class="o">//</span><span class="mi">2</span>
        
        <span class="c1"># Not sure which axis method is correct</span>
        <span class="k">if</span> <span class="n">axMethod</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">fftAxis</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">axMethod</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">fftAxis</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="n">sampleFreqHz</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        
        <span class="c1"># Take the FFT of the Signal</span>
        <span class="n">signalFFT</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Take the square value (it is complex) so following is equivalent:</span>
        <span class="c1"># Square of absolute, or</span>
        <span class="c1"># Sum of real squared and imag squared</span>
        <span class="n">spectralDensity</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">signalFFT</span><span class="p">[:,:</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">,:])</span><span class="o">**</span><span class="mi">2</span>
        
        <span class="c1">#Filter to the desired range</span>
        <span class="n">minPoint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">minFreq</span><span class="o">/</span><span class="p">(</span><span class="n">sampleFreqHz</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">maxPoint</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">maxFreq</span><span class="o">/</span><span class="p">(</span><span class="n">sampleFreqHz</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">sdAxis</span> <span class="o">=</span> <span class="n">fftAxis</span><span class="p">[</span><span class="n">minPoint</span><span class="p">:</span><span class="n">maxPoint</span><span class="p">]</span>
        <span class="n">sdValues</span> <span class="o">=</span> <span class="n">spectralDensity</span><span class="p">[:,</span><span class="n">minPoint</span><span class="p">:</span><span class="n">maxPoint</span><span class="p">,:]</span>
        
        <span class="k">return</span> <span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span></div>

               
<div class="viewcode-block" id="CostsFixedPSD.loss">
<a class="viewcode-back" href="../../../API/optimization.html#whobpyt.optimization.CostsFixedPSD.loss">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simData</span><span class="p">,</span> <span class="n">empData</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        NOTE: If using batching, the batches will be averaged before calculating the error (as opposed to having an error for each simulated time series in the batch).</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        simData: torch.tensor</span>
<span class="sd">            Simulated Data in the form [regions, time_steps, block/batch]</span>
<span class="sd">        empData: torch.tensor</span>
<span class="sd">            NOT IMPLEMENTED: This is a placeholder for the case of getting an empirical timeseries as input, which would be applicable if doing a windowed fitting paradigm</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        psdMSE:</span>
<span class="sd">            The MSE of the difference between the simulated and target power spectrum within the specified range</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sim</span> <span class="o">=</span> <span class="n">simData</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">simKey</span><span class="p">]</span>
        
        <span class="n">psdAxis</span><span class="p">,</span> <span class="n">psdValues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calcPSD</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">sampleFreqHz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">minFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minFreq</span><span class="p">,</span> <span class="n">maxFreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxFreq</span><span class="p">)</span> <span class="c1"># TODO: Sampling frequency of simulated data and target time series is currently assumed to be the same.</span>
        
        <span class="n">meanValue</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">psdValues</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="n">psdMSE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">meanValue</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">targetValue</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">psdMSE</span></div>
</div>

</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright KCNI Griffiths Lab &amp; Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>